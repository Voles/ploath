(function(){window.app=angular.module("app",["firebase"]),window.app.config(["$routeProvider",function(a){return a.when("/playlists",{controller:"PlaylistController",templateUrl:"views/playlist-overview.html"}).when("/playlists/:playlistId",{controller:"PlaylistController",templateUrl:"views/playlist-detail.html"}).when("/playlists/:playlistId/:trackId",{controller:"PlaylistController",templateUrl:"views/playlist-detail.html"}).when({controller:"LoginController",templateUrl:"views/login.html"}).otherwise({controller:"LoginController",templateUrl:"views/login.html"})}]),window.app.constant("config",{dbRef:new Firebase("https://ploath.firebaseio.com")}),window.app.constant("utilities",{makeUrlFriendly:function(a){return a.toLowerCase().replace(/^\s+|\s+$/g,"").replace(/[_|\s]+/g,"-").replace(/[^a-z0-9-]+/g,"").replace(/[-]+/g,"-").replace(/^-+|-+$/g,"")},makeAngularSafe:function(a){return a.toLowerCase().replace(/[\.]+/g,"").replace(/[#]+/g,"").replace(/[\$]+/g,"").replace(/[\/]+/g,"").replace(/[[]+/g,"").replace(/[\]]+/g,"")}})}).call(this),function(){window.app.factory("UserService",["angularFire","angularFireCollection","config","$rootScope","utilities","$q",function(a,b,c,d){var e;return a(c.dbRef+"/users",d,"users",{}),e={hasAccount:function(a){return"undefined"==typeof d.users[a]?!1:!0},registerAndLogin:function(b){var e;return e=a(c.dbRef+"/users/"+b.id,d,"user",{}),e.then(function(){return d.users[b.id]={name:b.displayName,facebookData:b,playlists:{}}})}}}])}.call(this),function(){window.app.factory("TrackService",["$rootScope","config","angularFire",function(a,b,c){var d;return c(b.dbRef+"/tracks",a,"tracks",{}),d={}}])}.call(this),function(){window.app.factory("PlaylistService",["$rootScope","config","angularFire","utilities",function(a,b,c,d){var e,f,g;return c(b.dbRef+"/playlists",a,"playlists",{}),g=function(b){var c;return null!=(c="undefined"==typeof a.playlists[b])?c:{"true":!1}},f=function(a,b){return b||(b=1),g(a+"-"+b)?a+"-"+b:f(a,b+1)},e={add:function(b){var c,e;e=d.makeUrlFriendly(b.name),c=f(e),a.playlists[c]={name:b.name,tracks:{}},a.user.playlists?a.user.playlists[c]=!0:a.user.playlists={generatedId:!0}},removeTrack:function(b,c){return delete a.playlists[b].tracks[c]}}}])}.call(this),function(){window.app.factory("AuthService",["angularFire","angularFireCollection","config","$rootScope","utilities","$location","UserService",function(a,b,c,d,e,f,g){var h,i,j;return j=a(c.dbRef+"/users",d,"users",{}),i=void 0,d.$watch("user",function(){return d.user?f.path("/playlists"):f.path("/login")}),j.then(function(){return i=new FirebaseSimpleLogin(c.dbRef,function(b,e){return b?(console.log(b),f.path("/login")):e?g.hasAccount(e.id)?a(c.dbRef+"/users/"+e.id,d,"user",{}):g.registerAndLogin(e):f.path("/login")})}),h={login:function(){return i.login("facebook",{remember_me:!0})},logout:function(){return i.logout()}}}])}.call(this),function(){app.controller("LoginController",["$scope","$rootScope","UserService","$location","AuthService",function(){}])}.call(this),function(){window.app.controller("PlaylistController",["$scope","angularFire","config","PlaylistService","$routeParams","$rootScope","TrackService","$location","AuthService",function(a,b,c,d,e,f,g,h,i){return b(c.dbRef+"/playlists/"+e.playlistId,a,"playlist",{}),a.play=function(a){h.path("/playlists/"+e.playlistId+"/"+a)},a.add=function(a){return d.add(a)},a.logout=function(){return i.logout()},a.removeTrack=function(a){return d.removeTrack(e.playlistId,a)}}])}.call(this),function(){window.app.controller("PlaylistManagerController",["$scope","$rootScope","PlaylistService",function(a){return a.editmode=!1,a.setEditmode=function(b){return a.editmode=b}}])}.call(this),function(){window.app.controller("TrackController",["$scope","angularFire","config","PlaylistService","$routeParams","$rootScope","TrackService","$location","AuthService",function(a,b,c,d,e){return b(c.dbRef+"/tracks/"+e.trackId,a,"track",{})}])}.call(this),function(){window.app.controller("ControlsController",["$scope",function(a){return a.playPause=function(){console.log("Play / pause")},a.next=function(){console.log("Next")},a.previous=function(){console.log("Previous")}}])}.call(this),function(){window.app.controller("UserController",["$scope","AuthService",function(a,b){return a.logout=function(){return b.logout()},a.login=function(){return b.login()}}])}.call(this);